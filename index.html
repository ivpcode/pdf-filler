<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compilatore PDF</title>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@mui/material@5.13.7/umd/material-ui.min.css" />
    <style>
        body {
            display: flex;
            height: 100vh;
            margin: 0;
            font-family: Roboto, sans-serif;
        }

        pdf-viewer {
            width: 100%;
        }
    </style>
    <script type="module" src="./src/pdf-compiler-component.js"></script>

</head>

<body>

    <pdf-viewer file_pdf="/file.pdf"></pdf-viewer>


    <script>

        document.addEventListener('DOMContentLoaded', () => {
            let resp = {
                success: true,
                data: {
                    ai: {
                        id: 65,
                        name: "Agevolazione IVA Condomini",
                        compiling_parameters: {
                            nome: {
                                value: "Mario Rossi",
                                question: "Qual è il nome del cliente richiedente?"
                            },
                            luogo_di_nascita: {
                                value: "Milano",
                                question: "Qual è il luogo di nascita del cliente richiedente?"
                            },
                            provincia_di_nascita: {
                                value: "Milano",
                                question: "Qual è la provincia del luogo di nascita del cliente richiedente?"
                            },
                            data_di_nascita: {
                                value: "01/01/1969",
                                question: "Qual è la data di nascita del cliente richiedente?"
                            },
                            ruolo: {
                                value: "Amministratore",
                                question: "Qual è il ruolo del cliente richiedente nella società?"
                            },
                            nome_societa: {
                                value: "Newco Srl",
                                question: "Qual è il nome della società richiedente?"
                            },
                            sede_legale: {
                                value: "Milano",
                                question: "Qual è la città della sede legale della società richiedente?"
                            },
                            provincia_sede: {
                                value: "MI",
                                question: "Qual è la provincia della sede legale della società richiedente?"
                            },
                            indirizzo_sede: {
                                value: "via Roma",
                                question: "Qual è l'indirizzo della sede legale della società richiedente?"
                            },
                            numero_civico: {
                                value: "1",
                                question: "Qual è il numero civico della sede legale della società richiedente?"
                            },
                            cap: {
                                value: "33100",
                                question: "Qual è il CAP della sede legale della società richiedente?"
                            },
                            codice_fiscale_1: {
                                value: "CFF23FFER123E",
                                question: "Qual è il codice fiscale della società richiedente?"
                            },
                            codice_ateco: {
                                value: "62.01",
                                question: "Qual è il codice ATECO della società richiedente?"
                            },
                            numero_telefono: {
                                value: "02123456789",
                                question: "Qual è il numero di telefono del referente della società richiedente?"
                            },
                            numero_fax: {
                                value: "02123456789",
                                question: "Qual è il numero di fax della società richiedente?"
                            },
                            email: {
                                value: "info@newco.it",
                                question: "Qual è l'email della società richiedente?"
                            },
                            pec: {
                                value: "newco@pec.it",
                                question: "Qual è l'indirizzo PEC della società richiedente?"
                            },
                            numero_contratto: {
                                value: "123456",
                                question: "Qual è il numero di contratto?"
                            },
							partita_iva: {
                                value: "0123456789",
                                question: "Qual è la partita IVA della società richiedente?"
                            },
                            codice_fiscale_2: {
                                value: "CFF23FFER123E",
                                question: "Qual è il codice fiscale dell'amministratore di condominio?"
                            },/*
                            codice_pod: {
                                value: "",
                                question: "Qual è il POD del condominio?"
                            },
                            numero_condomini: {
                                value: "",
                                question: "Quanti condomini sono inclusi nella presente dichiarazione?"
                            },
                            data: {
                                value: "",
                                question: "Qual è la data di sottoscrizione della richiesta?"
                            },

                            singolo_condominio: {
                                value: false,
                                question: "La dichiarazione è relativa a un singolo condominio?"
                            },
                            molti_condomini: {
                                value: false,
                                question: "La dichiarazione è relativa a più di un condominio?"
                            }*/
                        },
                        file_to_compile: {
                            name: "Agevolazione Iva Condomini",
                            url: "http://127.0.0.1:3000/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBYkU9IiwiZXhwIjoiMjAyNS0wNS0wOFQxNjozNjowNC43MDdaIiwicHVyIjoiYmxvYl9pZCJ9fQ==--ee8b62700aafb072f2059e28fa9376a69d6a1afc/AGEVOLAZIONE%20IVA%2010%EF%BF%BD%20CONDOMINI%20PARTI%20COMUNI%20aggiornamento%2017%20maggio%20compilabile.pdf"
                        },
                        files: [
                            {
                                id: 1,
                                name: "Carta d'identità",
                                uploaded: true,
                                status: "completed"
                            },
                            {
                                id: 2,
                                name: "informazioni societarie",
                                uploaded: true,
                                status: "completed"
                            }
                        ]
                    }
                }
            }

            const urlParams = new URLSearchParams(window.location.search);
            const pdfFile = urlParams.get('pdf') || '/file.pdf'; // Default a "/file.pdf" se non specificato

            const pdfViewer = document.querySelector('pdf-viewer');
            pdfViewer.setData({
                form_data: resp.data.ai.compiling_parameters,
                pdf_file: pdfFile
            });

            document.querySelectorAll('#pdf-form input').forEach((el) => {
                el.value = resp.data.ai.compiling_parameters[el.name].value;
            });
        });

    </script>

</body>

</html>